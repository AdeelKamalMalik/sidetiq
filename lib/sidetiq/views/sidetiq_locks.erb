<%= File.read(File.join(File.dirname(__FILE__), 'views', 'assets', 'styles.css')) %>

<header class="row">
  <div class="span5">
    <h3>Active Locks</h3>
  </div>
</header>

<div class="container-fluid sidetiq-container">
  <div class="row-fluid">
    <%= erb File.read(File.join(File.dirname(__FILE__), 'views', '_sidetiq_nav.erb')) %>

    <div class="span9">
      <% if @locks.length > 0 %>
      <table class="table table-striped table-bordered table-white" style="width: 100%; margin: 0; table-layout:fixed;">
        <thead>
          <th style="width: 20%">Key</th>
          <th style="width: 30%">Owner Node</th>
          <th style="width: 20%">Timetamp</th>
          <th style="width: 10%">TTL</th>
        </thead>

        <% @locks.each do |meta| %>
        <% pttl = meta.pttl %>

        <tr class="<%= 'error' if meta.stale? %>">
          <td><%= meta.key %></td>
          <td><%= meta.owner %></td>
          <td><%= meta.timestamp %></td>
          <td>
            <%= pttl / 1000 %> s
          </td>
        </tr>
        <% end %>
      </table>
      <% else %>
      <div class="alert alert-success">No locks set.</div>
      <% end %>
    </div>
  </div>
</div>

